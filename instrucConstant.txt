Please expand and improve this code, make it broader too.